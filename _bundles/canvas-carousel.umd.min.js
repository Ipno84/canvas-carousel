!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define("canvas-carousel",[],i):"object"==typeof exports?exports["canvas-carousel"]=i():t["canvas-carousel"]=i()}(self,(()=>(()=>{"use strict";var t={};return(()=>{var i=t;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasCarousel=void 0;var e=function(){function t(t){this._canvas=null,this._context=null,this._options={selector:"",imagesPath:[]},this._currentIndex=0,this._resizeObserver=null,this._imagesCollection=[],this.touch=navigator.maxTouchPoints>0,this.coors={},this.canvasPosition={deltaX:0},this.parentWidth=void 0,this.resizeTimeout=null,this.oldCanvasWidth=void 0,this.onResize=this.onResize.bind(this),this.onActionStart=this.onActionStart.bind(this),this.onActionEnd=this.onActionEnd.bind(this),this.onElementLeave=this.onElementLeave.bind(this),this.onActionMove=this.onActionMove.bind(this),this._options=t,this.onInit()}return Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){return this._currentIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeObserver",{get:function(){return this._resizeObserver},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imagesCollection",{get:function(){return this._imagesCollection},enumerable:!1,configurable:!0}),t.prototype.handleCanvasAssignment=function(){this.options.node&&this.options.node instanceof HTMLCanvasElement?this._canvas=this.options.node:this.options.selector&&(this._canvas=document.querySelector(this.options.selector))},t.prototype.onInit=function(){var t,i,e;this.handleCanvasAssignment(),this._context=null===(t=this.canvas)||void 0===t?void 0:t.getContext("2d"),this.context&&(this.context.imageSmoothingEnabled=!0),this.setupSize(),this.prepareImages(),(null===(i=this.canvas)||void 0===i?void 0:i.parentElement)&&(this._resizeObserver=new ResizeObserver(this.onResize),null===(e=this.resizeObserver)||void 0===e||e.observe(this.canvas.parentElement))},t.prototype.onResize=function(){var t,i,e,n=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.options.aspectRatio&&!this.oldCanvasWidth&&(null===(t=this.canvas)||void 0===t?void 0:t.width)&&(this.oldCanvasWidth=null===(i=this.canvas)||void 0===i?void 0:i.width),this.touch=navigator.maxTouchPoints>0,this.resizeTimeout=setTimeout((function(){n.addListeners(),n.setupSize(),n.handleCanvasReduction(),n.drawImages()}),null!==(e=this.options.resizeTimeoutReaction)&&void 0!==e?e:300)},t.prototype.handleCanvasReduction=function(){if(this.options.aspectRatio&&this.canvas&&this.oldCanvasWidth){var t=100*(this.oldCanvasWidth-this.canvas.width)/this.oldCanvasWidth/100;this.canvasPosition.deltaX||(this.canvasPosition.deltaX=0),this.canvasPosition.deltaX=this.canvasPosition.deltaX-this.canvasPosition.deltaX*t,this.oldCanvasWidth=void 0}},t.prototype.onActionStart=function(t){var i,e,n,o,s;t.preventDefault(),this.canvasRect=null===(i=this.canvas)||void 0===i?void 0:i.getBoundingClientRect();var a=this.touch&&t instanceof TouchEvent?t.touches[0]:t;this.coors.clientX=a.clientX-(null!==(n=null===(e=this.canvasRect)||void 0===e?void 0:e.left)&&void 0!==n?n:0)-(null!==(o=this.canvasPosition.deltaX)&&void 0!==o?o:0),null===(s=this.canvas)||void 0===s||s.addEventListener(this.touch?"touchmove":"mousemove",this.onActionMove)},t.prototype.onActionEnd=function(){var t;null===(t=this.canvas)||void 0===t||t.removeEventListener(this.touch?"touchmove":"mousemove",this.onActionMove)},t.prototype.onElementLeave=function(){var t,i;null===(t=this.canvas)||void 0===t||t.dispatchEvent(new Event("mouseup")),null===(i=this.canvas)||void 0===i||i.dispatchEvent(new Event("touchend"))},t.prototype.onActionMove=function(t){var i,e,n,o,s;t.preventDefault();var a=-(null!==(e=null===(i=this.canvas)||void 0===i?void 0:i.width)&&void 0!==e?e:0)*(this.options.imagesPath.length-1),h=this.touch&&t instanceof TouchEvent?t.touches[0]:t;this.coors.x=h.clientX-(null!==(o=null===(n=this.canvasRect)||void 0===n?void 0:n.left)&&void 0!==o?o:0),this.canvasPosition.deltaX=this.coors.x-(null!==(s=this.coors.clientX)&&void 0!==s?s:0),this.canvasPosition.deltaX>0?this.canvasPosition.deltaX=0:this.canvasPosition.deltaX<a&&(this.canvasPosition.deltaX=a),this.setupCurrentIndex(),this.drawImages()},t.prototype.setupCurrentIndex=function(){if(this.canvas&&void 0!==this.canvasPosition.deltaX){var t=Math.round((Math.abs(this.canvasPosition.deltaX)+this.canvas.width)/this.canvas.width)-1;t!==this.currentIndex&&(this._currentIndex=t)}},t.prototype.addListeners=function(){if(this.canvas){var t=this.touch?"touchstart":"mousedown",i=this.touch?"touchend":"mouseup",e=this.touch?"touchcancel":"mouseleave";this.canvas.removeEventListener("touchstart",this.onActionStart),this.canvas.removeEventListener("mousedown",this.onActionStart),this.canvas.removeEventListener("touchend",this.onActionEnd),this.canvas.removeEventListener("mouseup",this.onActionEnd),this.canvas.removeEventListener("touchcancel",this.onElementLeave),this.canvas.removeEventListener("mouseleave",this.onElementLeave),this.canvas.addEventListener(t,this.onActionStart),this.canvas.addEventListener(i,this.onActionEnd),this.canvas.addEventListener(e,this.onElementLeave)}},t.prototype.innerDimensions=function(t){var i=getComputedStyle(t),e=t.clientWidth,n=t.clientHeight;return{height:n-=Number.parseFloat(i.paddingTop)+Number.parseFloat(i.paddingBottom),width:e-=Number.parseFloat(i.paddingLeft)+Number.parseFloat(i.paddingRight)}},t.prototype.setupSize=function(){if(this.canvas&&this.options.aspectRatio){var t=this.canvas.parentNode;t&&(this.parentWidth=this.innerDimensions(t).width,this.canvas.width=this.parentWidth,this.canvas.height=this.parentWidth*this.options.aspectRatio)}else this.canvas&&this.options.canvasHeight&&this.options.canvasWidth&&(this.canvas.width=this.options.canvasWidth,this.canvas.height=this.options.canvasHeight)},t.prototype.prepareImages=function(){var t=this;this.options.imagesPath.forEach((function(i,e){var n=new Image;n.src=i,n.onload=function(){t._imagesCollection[e]=n,t.drawImages()}}))},t.prototype.getNormalizedImageSizes=function(t){if(this.canvas){var i=t.width/t.height;return i>1?{width:this.canvas.width,height:this.canvas.width/i}:{width:this.canvas.height*i,height:this.canvas.height}}return{width:0,height:0}},t.prototype.getDeltas=function(t,i){return this.canvas?{x:(this.canvas.width-t)/2,y:(this.canvas.height-i)/2}:{x:0,y:0}},t.prototype.goToIndex=function(t){if(this.canvas&&t>=0&&t<this.options.imagesPath.length){var i=0-this.canvas.width*t;this.canvasPosition.deltaX=i,this.drawImages(),this.setupCurrentIndex()}},t.prototype.goToNext=function(){this.goToIndex(this.currentIndex+1)},t.prototype.goToPrev=function(){this.goToIndex(this.currentIndex-1)},t.prototype.goToFirst=function(){this.goToIndex(0)},t.prototype.goToLast=function(){this.goToIndex(this.options.imagesPath.length-1)},t.prototype.drawImages=function(){var t,i,e,n,o,s=this;null===(t=this.context)||void 0===t||t.clearRect(0,0,null!==(e=null===(i=this.canvas)||void 0===i?void 0:i.width)&&void 0!==e?e:0,null!==(o=null===(n=this.canvas)||void 0===n?void 0:n.height)&&void 0!==o?o:0),this._imagesCollection.forEach((function(t,i){var e,n;if(s.canvas){var o=s.getNormalizedImageSizes(t),a=o.width,h=o.height,c=s.getDeltas(a,h),r=c.x,v=c.y;null===(e=s.context)||void 0===e||e.drawImage(t,s.canvas.width*i+r+(null!==(n=s.canvasPosition.deltaX)&&void 0!==n?n:0),v,a,h)}}))},t}();i.CanvasCarousel=e})(),t})()));
//# sourceMappingURL=canvas-carousel.umd.min.js.map